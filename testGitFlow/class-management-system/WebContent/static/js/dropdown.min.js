;(function($, window, undefined) {
    var $allDropdowns = $();
    $.fn.dropdownHover = function(options) {
        $allDropdowns = $allDropdowns.add(this.parent());
        return this.each(function() {
            var $this = $(this).parent(),
                defaults = {
                    delay: 500,
                    instantlyCloseOthers: true
                },
                data = {
                    delay: $(this).data('delay'),
                    instantlyCloseOthers: $(this).data('close-others')
                },
                options = $.extend(true, {}, defaults, options, data),
                timeout;
            $this.hover(function() {
                if(options.instantlyCloseOthers === true)
                    $allDropdowns.removeClass('open');
                window.clearTimeout(timeout);
                $(this).addClass('open');
            }, function() {
                timeout = window.setTimeout(function() {
                    $this.removeClass('open');
                }, options.delay);
            });
        });
    };
    $('[data-hover="dropdown"]').dropdownHover();
})(jQuery, this);

$(function(){
	var target = $('.dropdown-handler');
	target.bind('click',function(){
		var self = $(this).parent();
		if(self.hasClass('open')){
			self.removeClass('open');
		}else{
			self.addClass('open');
		}
	})
})

$(document).bind('click',function(e){
	var e = e || window.event; //浏览器兼容性
	var elem = e.target || e.srcElement;
	while (elem) { //循环判断至跟节点，防止点击的是div子元素
		if ($(elem).hasClass('dropdown-handler')) {
			return;
		}
		elem = elem.parentNode;
	}
    $('.dropdownClick').removeClass('open');//点击的不是div或其子元素
});
